var ge=Object.defineProperty;var be=(t,e,a)=>e in t?ge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var v=(t,e,a)=>be(t,typeof e!="symbol"?e+"":e,a);import{j as s,u as Q,Q as pe,a as ye}from"./query-CKRroiZA.js";import{a as we,r as o,b as ke}from"./vendor-Gm9i_4Ku.js";import{u as ve,L as X,a as je,R as Ne,b as q,B as Se}from"./router-jua2Vyaz.js";import{u as Ee,f as G,g as Te,a as Ce}from"./table-iqIhI9LJ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();var V={},z=we;V.createRoot=z.createRoot,V.hydrateRoot=z.hydrateRoot;function Me({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const De=o.forwardRef(Me);function Oe({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Pe=o.forwardRef(Oe);function Fe({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const We=o.forwardRef(Fe);function Re({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Le=o.forwardRef(Re);function $e({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const ne=o.forwardRef($e);function Ae({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const Ie=o.forwardRef(Ae);function Ye({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Zm-3 0h.008v.008h-.008v-.008Z"}))}const ie=o.forwardRef(Ye);function He({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const oe=o.forwardRef(He);function qe({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const $=o.forwardRef(qe);function _e({title:t,titleId:e,...a},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},a),t?o.createElement("title",{id:e},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Be=o.forwardRef(_e),J=[{name:"Dashboard",href:"/",icon:Ie},{name:"Skalds",href:"/skalds",icon:ie},{name:"Tasks",href:"/tasks",icon:ne}];function Ve({children:t}){const[e,a]=o.useState(!1),r=ve();return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsxs("div",{className:`fixed inset-0 z-40 lg:hidden ${e?"":"hidden"}`,children:[s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>a(!1)}),s.jsxs("div",{className:"relative flex w-full max-w-xs flex-1 flex-col bg-white",children:[s.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:s.jsx("button",{type:"button",className:"ml-1 flex h-10 w-10 items-center justify-center rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>a(!1),children:s.jsx(Be,{className:"h-6 w-6 text-white"})})}),s.jsxs("div",{className:"h-0 flex-1 overflow-y-auto pt-5 pb-4",children:[s.jsx("div",{className:"flex flex-shrink-0 items-center px-4",children:s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Skald Dashboard"})}),s.jsx("nav",{className:"mt-5 space-y-1 px-2",children:J.map(n=>{const i=r.pathname===n.href;return s.jsxs(X,{to:n.href,className:`group flex items-center px-2 py-2 text-base font-medium rounded-md ${i?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,onClick:()=>a(!1),children:[s.jsx(n.icon,{className:`mr-4 h-6 w-6 flex-shrink-0 ${i?"text-primary-500":"text-gray-400 group-hover:text-gray-500"}`}),n.name]},n.name)})})]})]})]}),s.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:s.jsx("div",{className:"flex min-h-0 flex-1 flex-col bg-white border-r border-gray-200",children:s.jsxs("div",{className:"flex flex-1 flex-col overflow-y-auto pt-5 pb-4",children:[s.jsx("div",{className:"flex flex-shrink-0 items-center px-4",children:s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Skald Dashboard"})}),s.jsx("nav",{className:"mt-5 flex-1 space-y-1 px-2",children:J.map(n=>{const i=r.pathname===n.href;return s.jsxs(X,{to:n.href,className:`group flex items-center px-2 py-2 text-sm font-medium rounded-md ${i?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[s.jsx(n.icon,{className:`mr-3 h-6 w-6 flex-shrink-0 ${i?"text-primary-500":"text-gray-400 group-hover:text-gray-500"}`}),n.name]},n.name)})})]})})}),s.jsxs("div",{className:"lg:pl-64",children:[s.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 lg:hidden",children:s.jsxs("div",{className:"flex h-16 items-center justify-between px-4",children:[s.jsx("button",{type:"button",className:"border-r border-gray-200 px-4 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 lg:hidden",onClick:()=>a(!0),children:s.jsx(De,{className:"h-6 w-6"})}),s.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Skald Dashboard"}),s.jsx("div",{className:"w-10"})," "]})}),s.jsx("main",{className:"flex-1",children:s.jsx("div",{className:"py-6",children:s.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:t})})})]})]})}const I=[{id:"skald-node-001",type:"node",status:"online",lastHeartbeat:new Date().toISOString(),supportedTasks:["data_processing","ml_training","file_conversion"],currentTasks:["task-001","task-003"]},{id:"skald-node-002",type:"node",status:"online",lastHeartbeat:new Date(Date.now()-3e4).toISOString(),supportedTasks:["data_processing","image_processing"],currentTasks:["task-002"]},{id:"skald-edge-001",type:"edge",status:"offline",lastHeartbeat:new Date(Date.now()-3e5).toISOString(),supportedTasks:["sensor_data","edge_computing"],currentTasks:[]}],O=[{id:"task-001",className:"data_processing",lifecycleStatus:"Running",executor:"skald-node-001",createDateTime:new Date(Date.now()-36e5).toISOString(),updateDateTime:new Date(Date.now()-18e5).toISOString(),attachments:{inputFile:"data.csv",outputPath:"/tmp/processed"},heartbeat:150,error:void 0,exception:void 0},{id:"task-002",className:"ml_training",lifecycleStatus:"Running",executor:"skald-node-002",createDateTime:new Date(Date.now()-72e5).toISOString(),updateDateTime:new Date(Date.now()-9e5).toISOString(),attachments:{model:"neural_network",dataset:"training_data.json"},heartbeat:75,error:void 0,exception:void 0},{id:"task-003",className:"file_conversion",lifecycleStatus:"Finished",executor:"skald-node-001",createDateTime:new Date(Date.now()-18e5).toISOString(),updateDateTime:new Date(Date.now()-3e5).toISOString(),attachments:{sourceFile:"document.pdf",targetFormat:"docx"},heartbeat:200,error:void 0,exception:void 0},{id:"task-004",className:"data_processing",lifecycleStatus:"Failed",executor:"skald-node-002",createDateTime:new Date(Date.now()-54e5).toISOString(),updateDateTime:new Date(Date.now()-36e5).toISOString(),attachments:{inputFile:"corrupted_data.csv"},heartbeat:-1,error:"File format not supported",exception:"ValueError: Invalid data format"},{id:"task-005",className:"image_processing",lifecycleStatus:"Created",executor:void 0,createDateTime:new Date(Date.now()-6e5).toISOString(),updateDateTime:new Date(Date.now()-6e5).toISOString(),attachments:{images:["img1.jpg","img2.jpg"],filter:"blur"},heartbeat:0,error:void 0,exception:void 0}];class Qe{constructor(){v(this,"baseUrl");v(this,"useMockData",!1);this.baseUrl="http://localhost:8000",this.useMockData=!1,console.log(`API Client initialized - Base URL: ${this.baseUrl}, Mock Data: ${this.useMockData}`)}async fetchApi(e,a){const r=`${this.baseUrl}${e}`;console.log(`Making API call to: ${r}`);try{const n=await fetch(r,{headers:{"Content-Type":"application/json",...a==null?void 0:a.headers},...a});if(!n.ok)throw console.error(`API call failed: ${n.status} ${n.statusText}`),new Error(`HTTP error! status: ${n.status} - ${n.statusText}`);const i=await n.json();return console.log(`API call successful for ${e}:`,i),i}catch(n){throw console.error(`API call failed for ${e}:`,n),n}}getMockData(e){if(e.includes("/api/skalds"))return{items:I,total:I.length};if(e.includes("/api/tasks"))return{items:O,total:O.length,page:1,pageSize:20};if(e.includes("/api/system/dashboard/summary"))return{totalSkalds:I.length,onlineSkalds:I.filter(a=>a.status==="online").length,totalTasks:O.length,runningTasks:O.filter(a=>a.lifecycleStatus==="Running").length,completedTasks:O.filter(a=>a.lifecycleStatus==="Finished").length,failedTasks:O.filter(a=>a.lifecycleStatus==="Failed").length};throw new Error(`No mock data available for ${e}`)}async getSkalds(){return this.fetchApi("/api/skalds/")}async getSkald(e){return this.fetchApi(`/api/skalds/${e}`)}async getTasks(e){const a=new URLSearchParams({page:e.page.toString(),pageSize:e.pageSize.toString()});return e.lifecycleStatus&&a.append("lifecycleStatus",e.lifecycleStatus),e.className&&a.append("className",e.className),e.executor&&a.append("executor",e.executor),this.fetchApi(`/api/tasks/?${a.toString()}`)}async getTask(e){return this.fetchApi(`/api/tasks/${e}`)}async updateTaskStatus(e,a){return this.fetchApi(`/api/tasks/${e}/status`,{method:"PUT",body:JSON.stringify(a)})}async updateTaskAttachments(e,a){return this.fetchApi(`/api/tasks/${e}/attachments`,{method:"PUT",body:JSON.stringify(a)})}async getDashboardSummary(){return this.fetchApi("/api/system/dashboard/summary")}}const U=new Qe;function ce(t){var e,a,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(a=ce(t[e]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}function _(){for(var t,e,a=0,r="",n=arguments.length;a<n;a++)(t=arguments[a])&&(e=ce(t))&&(r&&(r+=" "),r+=e);return r}const Ue={online:{color:"status-online",label:"Online",dotColor:"bg-success-500"},offline:{color:"status-offline",label:"Offline",dotColor:"bg-gray-500"},Created:{color:"status-created",label:"Created",dotColor:"bg-warning-500"},Assigning:{color:"status-assigning",label:"Assigning",dotColor:"bg-warning-500"},Running:{color:"status-running",label:"Running",dotColor:"bg-primary-500"},Paused:{color:"status-paused",label:"Paused",dotColor:"bg-warning-500"},Finished:{color:"status-finished",label:"Finished",dotColor:"bg-success-500"},Failed:{color:"status-failed",label:"Failed",dotColor:"bg-danger-500"},Cancelled:{color:"status-cancelled",label:"Cancelled",dotColor:"bg-gray-500"}},Xe={sm:{badge:"px-2 py-1 text-xs",dot:"w-2 h-2"},md:{badge:"px-2.5 py-1.5 text-sm",dot:"w-3 h-3"},lg:{badge:"px-3 py-2 text-base",dot:"w-4 h-4"}};function F({status:t,size:e="md",showLabel:a=!0,animated:r=!1}){const n=Ue[t],i=Xe[e];return n?a?s.jsxs("span",{className:_("inline-flex items-center gap-1.5 rounded-full border font-medium",n.color,i.badge),children:[s.jsx("div",{className:_("rounded-full",i.dot,n.dotColor,r&&(t==="online"||t==="Running")&&"animate-heartbeat")}),n.label]}):s.jsx("div",{className:"flex items-center",children:s.jsx("div",{className:_("rounded-full",i.dot,n.dotColor,r&&(t==="online"||t==="Running")&&"animate-pulse")})}):null}function Ge(){const t=je(),{data:e,isLoading:a,error:r}=Q({queryKey:["dashboard-summary"],queryFn:()=>U.getDashboardSummary(),retry:2,retryDelay:1e3});if(o.useEffect(()=>{console.log("Dashboard component mounted - API call status:",{isLoading:a,error:r,summary:e})},[a,r,e]),r)return console.error("Dashboard API error:",r),s.jsx("div",{className:"space-y-6",children:s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx($,{className:"h-5 w-5 text-red-400"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h3",{className:"text-sm font-medium text-red-800",children:"API Connection Error"}),s.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[s.jsx("p",{children:"Failed to load dashboard data. Please check:"}),s.jsxs("ul",{className:"list-disc list-inside mt-1",children:[s.jsx("li",{children:"SystemController backend is running"}),s.jsx("li",{children:"API endpoints are accessible"}),s.jsx("li",{children:"Network connectivity"})]}),s.jsxs("p",{className:"mt-2 font-mono text-xs bg-red-100 p-2 rounded",children:["Error: ",r instanceof Error?r.message:"Unknown error"]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-sm btn-primary",children:"Retry"})})]})]})})});if(a)return s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),s.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((i,d)=>s.jsx("div",{className:"card",children:s.jsxs("div",{className:"card-content",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})},d))})]})});const n=[{name:"Total Skalds",value:(e==null?void 0:e.totalSkalds)||0,subValue:`${(e==null?void 0:e.onlineSkalds)||0} online`,icon:ie,color:"text-primary-600",bgColor:"bg-primary-100"},{name:"Total Tasks",value:(e==null?void 0:e.totalTasks)||0,subValue:`${(e==null?void 0:e.runningTasks)||0} running`,icon:ne,color:"text-blue-600",bgColor:"bg-blue-100"},{name:"Finished Tasks",value:(e==null?void 0:e.completedTasks)||0,subValue:"Successfully finished",icon:Pe,color:"text-success-600",bgColor:"bg-success-100"},{name:"Failed Tasks",value:(e==null?void 0:e.failedTasks)||0,subValue:"Need attention",icon:$,color:"text-danger-600",bgColor:"bg-danger-100"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Overview of your Skald system status and performance"})]}),s.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:n.map(i=>s.jsx("div",{className:"card",children:s.jsx("div",{className:"card-content",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:`p-3 rounded-lg ${i.bgColor}`,children:s.jsx(i.icon,{className:`h-6 w-6 ${i.color}`})})}),s.jsxs("div",{className:"ml-4 flex-1",children:[s.jsx("div",{className:"text-sm font-medium text-gray-500",children:i.name}),s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.value}),s.jsx("div",{className:"text-xs text-gray-400",children:i.subValue})]})]})})},i.name))}),s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"System Status"})}),s.jsxs("div",{className:"card-content space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Skald Connectivity"}),s.jsxs("span",{className:"text-xs text-gray-500",children:[(e==null?void 0:e.onlineSkalds)||0," of ",(e==null?void 0:e.totalSkalds)||0," skalds online"]})]}),s.jsx("div",{className:"flex items-center space-x-2",children:(()=>{const i=e!=null&&e.totalSkalds?e.onlineSkalds/e.totalSkalds:0;return i===1?s.jsx("div",{title:"Status: Online - All Skald nodes are connected and operational",children:s.jsx(F,{status:"online",animated:!0})}):i>=.7?s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1.5 text-sm bg-warning-100 text-warning-800 border-warning-200 cursor-help",title:`Status: Partial - ${Math.round(i*100)}% of skalds online (≥70% threshold met, but not all nodes available)`,children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-warning-500 animate-pulse"}),"Partial"]}):i>0?s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1.5 text-sm bg-danger-100 text-danger-800 border-danger-200 cursor-help",title:`Status: Degraded - Only ${Math.round(i*100)}% of skalds online (<70% threshold, system performance may be impacted)`,children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-danger-500 animate-pulse"}),"Degraded"]}):s.jsx("div",{title:"Status: Offline - No Skald nodes are currently connected",children:s.jsx(F,{status:"offline",animated:!0})})})()})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Task Processing"}),s.jsx("span",{className:"text-xs text-gray-500",children:(()=>{const i=(e==null?void 0:e.runningTasks)||0,d=(e==null?void 0:e.completedTasks)||0,h=(e==null?void 0:e.failedTasks)||0;return i===0&&d===0&&h>0?"0 running, 0 finished, all failed":`${i} running, ${d} finished`})()})]}),s.jsx("div",{className:"flex items-center space-x-2",children:(()=>{const i=(e==null?void 0:e.runningTasks)||0,d=(e==null?void 0:e.failedTasks)||0;return i>0?s.jsx("div",{title:`Status: Running - ${i} task(s) currently being processed`,children:s.jsx(F,{status:"Running",animated:!0})}):d===0?s.jsx("div",{title:"Status: Finished - No active tasks, all previous tasks finished successfully",children:s.jsx(F,{status:"Finished"})}):s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1.5 text-sm bg-warning-100 text-warning-800 border-warning-200 cursor-help",title:`Status: Idle - No tasks running, but ${d} failed task(s) require attention`,children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-warning-500"}),"Idle"]})})()})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"System Health"}),s.jsxs("span",{className:"text-xs text-gray-500",children:[(e==null?void 0:e.failedTasks)||0," failed tasks detected"]})]}),s.jsx("div",{className:"flex items-center space-x-2",children:(()=>{const i=(e==null?void 0:e.failedTasks)||0,d=(e==null?void 0:e.totalTasks)||0,h=d>0?i/d:0;return i===0?s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1.5 text-sm bg-success-100 text-success-800 border-success-200 cursor-help",title:"Status: Healthy - No failed tasks detected, system operating normally",children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-success-500"}),"Healthy"]}):h<.1?s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1.5 text-sm bg-warning-100 text-warning-800 border-warning-200 cursor-help",title:`Status: Warning - ${i} failed task(s), failure rate ${Math.round(h*100)}% (<10% threshold, monitor closely)`,children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-warning-500 animate-pulse"}),"Warning"]}):s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1.5 text-sm bg-danger-100 text-danger-800 border-danger-200 cursor-help",title:`Status: Critical - ${i} failed task(s), failure rate ${Math.round(h*100)}% (≥10% threshold, immediate attention required)`,children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-danger-500 animate-pulse"}),"Critical"]})})()})]})]})]}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Quick Actions"})}),s.jsxs("div",{className:"card-content space-y-3",children:[s.jsx("button",{className:"btn btn-primary btn-md w-full",onClick:()=>t("/tasks"),children:"View All Tasks"}),s.jsx("button",{className:"btn btn-primary btn-md w-full",onClick:()=>t("/skalds"),children:"Monitor Skalds"}),s.jsx("button",{className:"btn btn-primary btn-md w-full",onClick:()=>alert("System Logs feature coming soon!"),children:"System Logs"})]})]})]}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-header",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Status Legend"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Understanding system status indicators and their logic"})]}),s.jsx("div",{className:"card-content",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 font-medium text-gray-900",children:"Category"}),s.jsx("th",{className:"text-left py-3 font-medium text-gray-900",children:"Status"}),s.jsx("th",{className:"text-left py-3 font-medium text-gray-900",children:"Logic & Conditions"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-100",children:[s.jsxs("tr",{children:[s.jsx("td",{rowSpan:4,className:"py-3 font-medium text-gray-900 align-top border-r border-gray-100",children:"Skald Connectivity"}),s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-success-100 text-success-800 border-success-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-success-500"}),"Online"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"All Skald nodes are connected and operational (100% online)"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-warning-100 text-warning-800 border-warning-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-warning-500"}),"Partial"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"≥70% of skalds online, but not all nodes are available"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-danger-100 text-danger-800 border-danger-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-danger-500"}),"Degraded"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"<70% of skalds online, system performance may be impacted"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-gray-100 text-gray-800 border-gray-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-500"}),"Offline"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"No Skald nodes are currently connected (0% online)"})]}),s.jsxs("tr",{children:[s.jsx("td",{rowSpan:3,className:"py-3 font-medium text-gray-900 align-top border-r border-gray-100",children:"Task Processing"}),s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-primary-100 text-primary-800 border-primary-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-500"}),"Running"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"One or more tasks are currently being processed"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-success-100 text-success-800 border-success-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-success-500"}),"Finished"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"No active tasks, all previous tasks finished successfully"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-warning-100 text-warning-800 border-warning-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-warning-500"}),"Idle"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"No tasks currently running, but failed tasks exist and require attention"})]}),s.jsxs("tr",{children:[s.jsx("td",{rowSpan:3,className:"py-3 font-medium text-gray-900 align-top border-r border-gray-100",children:"System Health"}),s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-success-100 text-success-800 border-success-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-success-500"}),"Healthy"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"No failed tasks detected, system operating normally (0% failure rate)"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-warning-100 text-warning-800 border-warning-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-warning-500"}),"Warning"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"Task failure rate <10%, system should be monitored closely"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs bg-danger-100 text-danger-800 border-danger-200",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-danger-500"}),"Critical"]})}),s.jsx("td",{className:"py-3 text-gray-600",children:"Task failure rate ≥10%, immediate attention and intervention required"})]})]})]})})})]})]})}function le({data:t,columns:e,loading:a=!1,pagination:r,onRowClick:n}){const[i,d]=o.useState([]),h=e.map(l=>({accessorKey:l.key,header:l.header,enableSorting:l.sortable??!0,cell:({getValue:u,row:b})=>{const j=u();return l.render?l.render(j,b.original):String(j)}})),x=Ee({data:t,columns:h,state:{sorting:i},onSortingChange:d,getCoreRowModel:Ce(),getSortedRowModel:Te()});return a?s.jsx("div",{className:"card",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"card-header",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"})}),s.jsx("div",{className:"card-content space-y-3",children:[...Array(5)].map((l,u)=>s.jsx("div",{className:"h-4 bg-gray-200 rounded"},u))})]})}):s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:x.getHeaderGroups().map(l=>s.jsx("tr",{className:"border-b border-gray-200",children:l.headers.map(u=>s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:u.isPlaceholder?null:s.jsxs("div",{className:`flex items-center gap-2 ${u.column.getCanSort()?"cursor-pointer select-none":""}`,onClick:u.column.getToggleSortingHandler(),children:[G(u.column.columnDef.header,u.getContext()),u.column.getCanSort()&&s.jsxs("span",{className:"flex flex-col",children:[s.jsx(Le,{className:`w-3 h-3 ${u.column.getIsSorted()==="asc"?"text-primary-600":"text-gray-400"}`}),s.jsx(We,{className:`w-3 h-3 -mt-1 ${u.column.getIsSorted()==="desc"?"text-primary-600":"text-gray-400"}`})]})]})},u.id))},l.id))}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.getRowModel().rows.map(l=>s.jsx("tr",{className:`hover:bg-gray-50 ${n?"cursor-pointer":""}`,onClick:()=>n==null?void 0:n(l.original),children:l.getVisibleCells().map(u=>s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:G(u.column.columnDef.cell,u.getContext())},u.id))},l.id))})]})}),r&&s.jsxs("div",{className:"card-footer flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(r.page-1)*r.pageSize+1," to"," ",Math.min(r.page*r.pageSize,r.total)," of"," ",r.total," results"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>r.onPageChange(r.page-1),disabled:r.page<=1,children:"Previous"}),s.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",r.page," of ",Math.ceil(r.total/r.pageSize)]}),s.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>r.onPageChange(r.page+1),disabled:r.page>=Math.ceil(r.total/r.pageSize),children:"Next"})]})]})]})}class ze{constructor(e="/api/events"){v(this,"skaldEventSource",null);v(this,"taskEventSource",null);v(this,"skaldCallbacks",new Map);v(this,"taskCallbacks",new Map);v(this,"connectionCallbacks",[]);v(this,"reconnectAttempts",0);v(this,"maxReconnectAttempts",5);v(this,"reconnectDelay",1e3);v(this,"connected",!1);v(this,"lastError",null);this.baseUrl=e}connect(){this.connectSkaldEvents(),this.connectTaskEvents()}disconnect(){this.disconnectSkaldEvents(),this.disconnectTaskEvents(),this.connected=!1,this.notifyConnectionState(!1)}reconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("Max reconnection attempts reached");return}this.reconnectAttempts++;const e=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);console.log(`Attempting to reconnect in ${e}ms (attempt ${this.reconnectAttempts})`),setTimeout(()=>{this.disconnect(),this.connect()},e)}connectSkaldEvents(){try{this.skaldEventSource=new EventSource(`${this.baseUrl}/skalds`),this.skaldEventSource.onopen=()=>{console.log("Skald SSE connection opened"),this.reconnectAttempts=0,this.connected=!0,this.lastError=null,this.notifyConnectionState(!0)},this.skaldEventSource.onmessage=e=>{try{const a=JSON.parse(e.data);this.handleSkaldEvent(a)}catch(a){console.error("Error parsing Skald event:",a)}},this.skaldEventSource.onerror=e=>{var a;console.error("Skald SSE error:",e),this.lastError=new Error("Skald SSE connection error"),this.connected=!1,this.notifyConnectionState(!1),((a=this.skaldEventSource)==null?void 0:a.readyState)===EventSource.CLOSED&&this.reconnect()}}catch(e){console.error("Failed to connect to Skald events:",e),this.lastError=e}}disconnectSkaldEvents(){this.skaldEventSource&&(this.skaldEventSource.close(),this.skaldEventSource=null)}connectTaskEvents(){try{this.taskEventSource=new EventSource(`${this.baseUrl}/tasks`),this.taskEventSource.onopen=()=>{console.log("Task SSE connection opened")},this.taskEventSource.onmessage=e=>{try{const a=JSON.parse(e.data);this.handleTaskEvent(a)}catch(a){console.error("Error parsing Task event:",a)}},this.taskEventSource.onerror=e=>{var a;console.error("Task SSE error:",e),this.lastError=new Error("Task SSE connection error"),((a=this.taskEventSource)==null?void 0:a.readyState)===EventSource.CLOSED&&this.reconnect()}}catch(e){console.error("Failed to connect to Task events:",e),this.lastError=e}}disconnectTaskEvents(){this.taskEventSource&&(this.taskEventSource.close(),this.taskEventSource=null)}subscribeToSkald(e,a){return this.skaldCallbacks.has(e)||this.skaldCallbacks.set(e,[]),this.skaldCallbacks.get(e).push(a),()=>{const r=this.skaldCallbacks.get(e);if(r){const n=r.indexOf(a);n>-1&&r.splice(n,1),r.length===0&&this.skaldCallbacks.delete(e)}}}subscribeToTask(e,a){return this.taskCallbacks.has(e)||this.taskCallbacks.set(e,[]),this.taskCallbacks.get(e).push(a),()=>{const r=this.taskCallbacks.get(e);if(r){const n=r.indexOf(a);n>-1&&r.splice(n,1),r.length===0&&this.taskCallbacks.delete(e)}}}subscribeToConnection(e){return this.connectionCallbacks.push(e),()=>{const a=this.connectionCallbacks.indexOf(e);a>-1&&this.connectionCallbacks.splice(a,1)}}handleSkaldEvent(e){const a=this.skaldCallbacks.get(e.skaldId);a&&a.forEach(r=>{try{r(e)}catch(n){console.error("Error in Skald event callback:",n)}})}handleTaskEvent(e){const a=this.taskCallbacks.get(e.taskId);a&&a.forEach(r=>{try{r(e)}catch(n){console.error("Error in Task event callback:",n)}})}notifyConnectionState(e){this.connectionCallbacks.forEach(a=>{try{a(e)}catch(r){console.error("Error in connection state callback:",r)}})}isConnected(){return this.connected}getLastError(){return this.lastError}startMockEvents(){}startMockSkaldEvents(){const e=["skald-node-001","skald-node-002","skald-edge-001"];setInterval(()=>{const r={type:"skald_heartbeat",skaldId:e[Math.floor(Math.random()*e.length)],data:{heartbeat:Math.floor(Math.random()*100)}};this.handleSkaldEvent(r)},5e3)}startMockTaskEvents(){const e=["task-001","task-002","task-003","task-004","task-005"];setInterval(()=>{const r={type:"task_heartbeat",taskId:e[Math.floor(Math.random()*e.length)],data:{heartbeat:Math.floor(Math.random()*200)}};this.handleTaskEvent(r)},3e3)}}const Je="http://localhost:8000/api/events",w=new ze(Je),de=o.createContext(void 0);function Ze({children:t}){const[e,a]=o.useState(!1),[r,n]=o.useState(null),[i,d]=o.useState(new Map),[h,x]=o.useState(new Map),l=o.useCallback((c,f)=>{d(S=>{const y=new Map(S),W=y.get(c);return W?y.set(c,{...W,...f}):y.set(c,{id:c,type:"node",status:"offline",lastHeartbeat:new Date().toISOString(),supportedTasks:[],currentTasks:[],...f}),y})},[]),u=o.useCallback((c,f)=>{x(S=>{const y=new Map(S),W=y.get(c);return W?y.set(c,{...W,...f}):y.set(c,{id:c,className:"Unknown",lifecycleStatus:"Created",createDateTime:new Date().toISOString(),updateDateTime:new Date().toISOString(),attachments:{},heartbeat:0,...f}),y})},[]),b=o.useCallback(c=>{console.log("Received Skald event:",c);const f={};switch(c.type){case"skald_status":c.data.status&&(f.status=c.data.status),c.data.tasks&&(f.currentTasks=c.data.tasks);break;case"skald_heartbeat":c.data.heartbeat!==void 0&&(f.lastHeartbeat=new Date().toISOString(),f.status="online"),c.data.tasks&&(f.currentTasks=c.data.tasks);break}Object.keys(f).length>0&&l(c.skaldId,f)},[l]),j=o.useCallback(c=>{console.log("Received Task event:",c);const f={updateDateTime:new Date().toISOString()};switch(c.data.lifecycleStatus!==void 0&&(f.lifecycleStatus=c.data.lifecycleStatus),c.type){case"task_heartbeat":c.data.heartbeat!==void 0&&(f.heartbeat=c.data.heartbeat);break;case"task_error":c.data.error&&(f.error=c.data.error,f.lifecycleStatus="Failed");break;case"task_exception":c.data.exception&&(f.exception=c.data.exception,f.lifecycleStatus="Failed");break}u(c.taskId,f)},[u]),E=o.useCallback((c,f)=>w.subscribeToSkald(c,f),[]),k=o.useCallback((c,f)=>w.subscribeToTask(c,f),[]),p=o.useCallback(()=>{w.connect()},[]),C=o.useCallback(()=>{w.disconnect()},[]);o.useEffect(()=>{const c=w.subscribeToConnection(y=>{a(y),n(y?null:w.getLastError())}),f=w.handleSkaldEvent.bind(w),S=w.handleTaskEvent.bind(w);return w.handleSkaldEvent=y=>{f(y),b(y)},w.handleTaskEvent=y=>{S(y),j(y)},w.connect(),()=>{w.handleSkaldEvent=f,w.handleTaskEvent=S,c(),w.disconnect()}},[b,j]),o.useEffect(()=>{const c=setInterval(()=>{a(w.isConnected()),n(w.getLastError())},1e3);return()=>clearInterval(c)},[]);const m={isConnected:e,lastError:r,skalds:i,updateSkald:l,tasks:h,updateTask:u,subscribeToSkald:E,subscribeToTask:k,connect:p,disconnect:C};return s.jsx(de.Provider,{value:m,children:t})}function ue(){const t=o.useContext(de);if(t===void 0)throw new Error("useSSE must be used within an SSEProvider");return t}function Ke(){const{data:t,isLoading:e,error:a}=Q({queryKey:["skalds"],queryFn:()=>U.getSkalds(),retry:2,retryDelay:1e3}),{skalds:r,isConnected:n,lastError:i,updateSkald:d}=ue(),h=o.useMemo(()=>t!=null&&t.items?t.items.map(l=>{const u=r.get(l.id);return u?{...l,...u,supportedTasks:l.supportedTasks,type:l.type}:l}):[],[t==null?void 0:t.items,r]);if(o.useEffect(()=>{if(!(t!=null&&t.items))return;const l=[];return t.items.forEach(u=>{r.has(u.id)||d(u.id,u)}),()=>{l.forEach(u=>u())}},[t==null?void 0:t.items,r,d]),o.useEffect(()=>{var l;console.log("SkaldsPage status:",{isLoading:e,error:a,skalds:((l=t==null?void 0:t.items)==null?void 0:l.length)||0,sseConnected:n,sseError:i,sseSkalds:r.size})},[e,a,t,n,i,r]),a)return console.error("Skalds API error:",a),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Skalds"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Monitor and manage your Skald workers"})]}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx($,{className:"h-5 w-5 text-red-400"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Failed to Load Skalds"}),s.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[s.jsx("p",{children:"Unable to fetch Skald data from the API."}),s.jsxs("p",{className:"mt-2 font-mono text-xs bg-red-100 p-2 rounded",children:["Error: ",a instanceof Error?a.message:"Unknown error"]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-sm btn-primary",children:"Retry"})})]})]})})]});const x=[{key:"id",header:"Skald ID",sortable:!0},{key:"type",header:"Type",sortable:!0,render:l=>s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${l==="node"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:l})},{key:"status",header:"Status",sortable:!0,render:l=>s.jsx(F,{status:l,animated:!0})},{key:"supportedTasks",header:"Supported Tasks",sortable:!1,render:l=>s.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.slice(0,3).map((u,b)=>s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800",children:u},b)),l.length>3&&s.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800",children:["+",l.length-3," more"]})]})},{key:"currentTasks",header:"Current Tasks",sortable:!0,render:l=>s.jsx("span",{className:"text-sm text-gray-900",children:l.length})}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Skalds"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Monitor and manage your Skald workers"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(oe,{className:`h-5 w-5 ${n?"text-green-500":"text-red-500"}`}),s.jsx("span",{className:`text-sm font-medium ${n?"text-green-700":"text-red-700"}`,children:n?"Live Updates":"Disconnected"}),i&&s.jsx("span",{className:"text-xs text-red-500",title:i.message,children:"(Error)"})]})]}),s.jsx(le,{data:h,columns:x,loading:e})]})}function N(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function D(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}const he=6048e5,et=864e5;let tt={};function H(){return tt}function A(t,e){var h,x,l,u;const a=H(),r=(e==null?void 0:e.weekStartsOn)??((x=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:x.weekStartsOn)??a.weekStartsOn??((u=(l=a.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??0,n=N(t),i=n.getDay(),d=(i<r?7:0)+i-r;return n.setDate(n.getDate()-d),n.setHours(0,0,0,0),n}function Y(t){return A(t,{weekStartsOn:1})}function me(t){const e=N(t),a=e.getFullYear(),r=D(t,0);r.setFullYear(a+1,0,4),r.setHours(0,0,0,0);const n=Y(r),i=D(t,0);i.setFullYear(a,0,4),i.setHours(0,0,0,0);const d=Y(i);return e.getTime()>=n.getTime()?a+1:e.getTime()>=d.getTime()?a:a-1}function Z(t){const e=N(t);return e.setHours(0,0,0,0),e}function K(t){const e=N(t),a=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return a.setUTCFullYear(e.getFullYear()),+t-+a}function at(t,e){const a=Z(t),r=Z(e),n=+a-K(a),i=+r-K(r);return Math.round((n-i)/et)}function st(t){const e=me(t),a=D(t,0);return a.setFullYear(e,0,4),a.setHours(0,0,0,0),Y(a)}function rt(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function nt(t){if(!rt(t)&&typeof t!="number")return!1;const e=N(t);return!isNaN(Number(e))}function it(t){const e=N(t),a=D(t,0);return a.setFullYear(e.getFullYear(),0,1),a.setHours(0,0,0,0),a}const ot={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ct=(t,e,a)=>{let r;const n=ot[t];return typeof n=="string"?r=n:e===1?r=n.one:r=n.other.replace("{{count}}",e.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+r:r+" ago":r};function B(t){return(e={})=>{const a=e.width?String(e.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const lt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},dt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ut={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ht={date:B({formats:lt,defaultWidth:"full"}),time:B({formats:dt,defaultWidth:"full"}),dateTime:B({formats:ut,defaultWidth:"full"})},mt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ft=(t,e,a,r)=>mt[t];function R(t){return(e,a)=>{const r=a!=null&&a.context?String(a.context):"standalone";let n;if(r==="formatting"&&t.formattingValues){const d=t.defaultFormattingWidth||t.defaultWidth,h=a!=null&&a.width?String(a.width):d;n=t.formattingValues[h]||t.formattingValues[d]}else{const d=t.defaultWidth,h=a!=null&&a.width?String(a.width):t.defaultWidth;n=t.values[h]||t.values[d]}const i=t.argumentCallback?t.argumentCallback(e):e;return n[i]}}const xt={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},gt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},bt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},pt={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},yt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},wt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kt=(t,e)=>{const a=Number(t),r=a%100;if(r>20||r<10)switch(r%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},vt={ordinalNumber:kt,era:R({values:xt,defaultWidth:"wide"}),quarter:R({values:gt,defaultWidth:"wide",argumentCallback:t=>t-1}),month:R({values:bt,defaultWidth:"wide"}),day:R({values:pt,defaultWidth:"wide"}),dayPeriod:R({values:yt,defaultWidth:"wide",formattingValues:wt,defaultFormattingWidth:"wide"})};function L(t){return(e,a={})=>{const r=a.width,n=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(n);if(!i)return null;const d=i[0],h=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],x=Array.isArray(h)?Nt(h,b=>b.test(d)):jt(h,b=>b.test(d));let l;l=t.valueCallback?t.valueCallback(x):x,l=a.valueCallback?a.valueCallback(l):l;const u=e.slice(d.length);return{value:l,rest:u}}}function jt(t,e){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&e(t[a]))return a}function Nt(t,e){for(let a=0;a<t.length;a++)if(e(t[a]))return a}function St(t){return(e,a={})=>{const r=e.match(t.matchPattern);if(!r)return null;const n=r[0],i=e.match(t.parsePattern);if(!i)return null;let d=t.valueCallback?t.valueCallback(i[0]):i[0];d=a.valueCallback?a.valueCallback(d):d;const h=e.slice(n.length);return{value:d,rest:h}}}const Et=/^(\d+)(th|st|nd|rd)?/i,Tt=/\d+/i,Ct={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Mt={any:[/^b/i,/^(a|c)/i]},Dt={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ot={any:[/1/i,/2/i,/3/i,/4/i]},Pt={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ft={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Wt={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Rt={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Lt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$t={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},At={ordinalNumber:St({matchPattern:Et,parsePattern:Tt,valueCallback:t=>parseInt(t,10)}),era:L({matchPatterns:Ct,defaultMatchWidth:"wide",parsePatterns:Mt,defaultParseWidth:"any"}),quarter:L({matchPatterns:Dt,defaultMatchWidth:"wide",parsePatterns:Ot,defaultParseWidth:"any",valueCallback:t=>t+1}),month:L({matchPatterns:Pt,defaultMatchWidth:"wide",parsePatterns:Ft,defaultParseWidth:"any"}),day:L({matchPatterns:Wt,defaultMatchWidth:"wide",parsePatterns:Rt,defaultParseWidth:"any"}),dayPeriod:L({matchPatterns:Lt,defaultMatchWidth:"any",parsePatterns:$t,defaultParseWidth:"any"})},It={code:"en-US",formatDistance:ct,formatLong:ht,formatRelative:ft,localize:vt,match:At,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Yt(t){const e=N(t);return at(e,it(e))+1}function Ht(t){const e=N(t),a=+Y(e)-+st(e);return Math.round(a/he)+1}function fe(t,e){var u,b,j,E;const a=N(t),r=a.getFullYear(),n=H(),i=(e==null?void 0:e.firstWeekContainsDate)??((b=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:b.firstWeekContainsDate)??n.firstWeekContainsDate??((E=(j=n.locale)==null?void 0:j.options)==null?void 0:E.firstWeekContainsDate)??1,d=D(t,0);d.setFullYear(r+1,0,i),d.setHours(0,0,0,0);const h=A(d,e),x=D(t,0);x.setFullYear(r,0,i),x.setHours(0,0,0,0);const l=A(x,e);return a.getTime()>=h.getTime()?r+1:a.getTime()>=l.getTime()?r:r-1}function qt(t,e){var h,x,l,u;const a=H(),r=(e==null?void 0:e.firstWeekContainsDate)??((x=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:x.firstWeekContainsDate)??a.firstWeekContainsDate??((u=(l=a.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??1,n=fe(t,e),i=D(t,0);return i.setFullYear(n,0,r),i.setHours(0,0,0,0),A(i,e)}function _t(t,e){const a=N(t),r=+A(a,e)-+qt(a,e);return Math.round(r/he)+1}function g(t,e){const a=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return a+r}const T={y(t,e){const a=t.getFullYear(),r=a>0?a:1-a;return g(e==="yy"?r%100:r,e.length)},M(t,e){const a=t.getMonth();return e==="M"?String(a+1):g(a+1,2)},d(t,e){return g(t.getDate(),e.length)},a(t,e){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,e){return g(t.getHours()%12||12,e.length)},H(t,e){return g(t.getHours(),e.length)},m(t,e){return g(t.getMinutes(),e.length)},s(t,e){return g(t.getSeconds(),e.length)},S(t,e){const a=e.length,r=t.getMilliseconds(),n=Math.trunc(r*Math.pow(10,a-3));return g(n,e.length)}},P={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ee={G:function(t,e,a){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})}},y:function(t,e,a){if(e==="yo"){const r=t.getFullYear(),n=r>0?r:1-r;return a.ordinalNumber(n,{unit:"year"})}return T.y(t,e)},Y:function(t,e,a,r){const n=fe(t,r),i=n>0?n:1-n;if(e==="YY"){const d=i%100;return g(d,2)}return e==="Yo"?a.ordinalNumber(i,{unit:"year"}):g(i,e.length)},R:function(t,e){const a=me(t);return g(a,e.length)},u:function(t,e){const a=t.getFullYear();return g(a,e.length)},Q:function(t,e,a){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return g(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,a){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return g(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,a){const r=t.getMonth();switch(e){case"M":case"MM":return T.M(t,e);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,a){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return g(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,a,r){const n=_t(t,r);return e==="wo"?a.ordinalNumber(n,{unit:"week"}):g(n,e.length)},I:function(t,e,a){const r=Ht(t);return e==="Io"?a.ordinalNumber(r,{unit:"week"}):g(r,e.length)},d:function(t,e,a){return e==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):T.d(t,e)},D:function(t,e,a){const r=Yt(t);return e==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):g(r,e.length)},E:function(t,e,a){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,a,r){const n=t.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return g(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(n,{width:"short",context:"formatting"});case"eeee":default:return a.day(n,{width:"wide",context:"formatting"})}},c:function(t,e,a,r){const n=t.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return g(i,e.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(n,{width:"narrow",context:"standalone"});case"cccccc":return a.day(n,{width:"short",context:"standalone"});case"cccc":default:return a.day(n,{width:"wide",context:"standalone"})}},i:function(t,e,a){const r=t.getDay(),n=r===0?7:r;switch(e){case"i":return String(n);case"ii":return g(n,e.length);case"io":return a.ordinalNumber(n,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});case"iiii":default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,a){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,e,a){const r=t.getHours();let n;switch(r===12?n=P.noon:r===0?n=P.midnight:n=r/12>=1?"pm":"am",e){case"b":case"bb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,e,a){const r=t.getHours();let n;switch(r>=17?n=P.evening:r>=12?n=P.afternoon:r>=4?n=P.morning:n=P.night,e){case"B":case"BB":case"BBB":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,e,a){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return T.h(t,e)},H:function(t,e,a){return e==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):T.H(t,e)},K:function(t,e,a){const r=t.getHours()%12;return e==="Ko"?a.ordinalNumber(r,{unit:"hour"}):g(r,e.length)},k:function(t,e,a){let r=t.getHours();return r===0&&(r=24),e==="ko"?a.ordinalNumber(r,{unit:"hour"}):g(r,e.length)},m:function(t,e,a){return e==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):T.m(t,e)},s:function(t,e,a){return e==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):T.s(t,e)},S:function(t,e){return T.S(t,e)},X:function(t,e,a){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return ae(r);case"XXXX":case"XX":return M(r);case"XXXXX":case"XXX":default:return M(r,":")}},x:function(t,e,a){const r=t.getTimezoneOffset();switch(e){case"x":return ae(r);case"xxxx":case"xx":return M(r);case"xxxxx":case"xxx":default:return M(r,":")}},O:function(t,e,a){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+te(r,":");case"OOOO":default:return"GMT"+M(r,":")}},z:function(t,e,a){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+te(r,":");case"zzzz":default:return"GMT"+M(r,":")}},t:function(t,e,a){const r=Math.trunc(t.getTime()/1e3);return g(r,e.length)},T:function(t,e,a){const r=t.getTime();return g(r,e.length)}};function te(t,e=""){const a=t>0?"-":"+",r=Math.abs(t),n=Math.trunc(r/60),i=r%60;return i===0?a+String(n):a+String(n)+e+g(i,2)}function ae(t,e){return t%60===0?(t>0?"-":"+")+g(Math.abs(t)/60,2):M(t,e)}function M(t,e=""){const a=t>0?"-":"+",r=Math.abs(t),n=g(Math.trunc(r/60),2),i=g(r%60,2);return a+n+e+i}const se=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},xe=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Bt=(t,e)=>{const a=t.match(/(P+)(p+)?/)||[],r=a[1],n=a[2];if(!n)return se(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",se(r,e)).replace("{{time}}",xe(n,e))},Vt={p:xe,P:Bt},Qt=/^D+$/,Ut=/^Y+$/,Xt=["D","DD","YY","YYYY"];function Gt(t){return Qt.test(t)}function zt(t){return Ut.test(t)}function Jt(t,e,a){const r=Zt(t,e,a);if(console.warn(r),Xt.includes(t))throw new RangeError(r)}function Zt(t,e,a){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Kt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ea=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ta=/^'([^]*?)'?$/,aa=/''/g,sa=/[a-zA-Z]/;function re(t,e,a){var u,b,j,E;const r=H(),n=r.locale??It,i=r.firstWeekContainsDate??((b=(u=r.locale)==null?void 0:u.options)==null?void 0:b.firstWeekContainsDate)??1,d=r.weekStartsOn??((E=(j=r.locale)==null?void 0:j.options)==null?void 0:E.weekStartsOn)??0,h=N(t);if(!nt(h))throw new RangeError("Invalid time value");let x=e.match(ea).map(k=>{const p=k[0];if(p==="p"||p==="P"){const C=Vt[p];return C(k,n.formatLong)}return k}).join("").match(Kt).map(k=>{if(k==="''")return{isToken:!1,value:"'"};const p=k[0];if(p==="'")return{isToken:!1,value:ra(k)};if(ee[p])return{isToken:!0,value:k};if(p.match(sa))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:k}});n.localize.preprocessor&&(x=n.localize.preprocessor(h,x));const l={firstWeekContainsDate:i,weekStartsOn:d,locale:n};return x.map(k=>{if(!k.isToken)return k.value;const p=k.value;(zt(p)||Gt(p))&&Jt(p,e,String(t));const C=ee[p[0]];return C(h,p,n.localize,l)}).join("")}function ra(t){const e=t.match(ta);return e?e[1].replace(aa,"'"):t}function na(){const[t,e]=o.useState(1),[a,r]=o.useState(),n=10,{data:i,isLoading:d,error:h}=Q({queryKey:["tasks",t,a],queryFn:()=>U.getTasks({page:t,pageSize:n,lifecycleStatus:a}),retry:2,retryDelay:1e3}),{tasks:x,isConnected:l,lastError:u,updateTask:b,subscribeToTask:j}=ue(),E=o.useMemo(()=>Array.from(x.entries()).map(([m,c])=>`${m}:${c.heartbeat}:${c.lifecycleStatus}:${c.updateDateTime}`).join("|"),[x]),k=o.useMemo(()=>i!=null&&i.items?i.items.map(m=>{const c=x.get(m.id);return c?{...m,...c,className:m.className,createDateTime:m.createDateTime}:m}):[],[i==null?void 0:i.items,E]);if(o.useEffect(()=>{if(!(i!=null&&i.items))return;const m=[];return i.items.forEach(c=>{x.has(c.id)||b(c.id,c)}),()=>{m.forEach(c=>c())}},[i==null?void 0:i.items,x,b,j]),h)return console.error("Tasks API error:",h),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tasks"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Monitor and manage task execution"})]})}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx($,{className:"h-5 w-5 text-red-400"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Failed to Load Tasks"}),s.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[s.jsx("p",{children:"Unable to fetch task data from the API."}),s.jsxs("p",{className:"mt-2 font-mono text-xs bg-red-100 p-2 rounded",children:["Error: ",h instanceof Error?h.message:"Unknown error"]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-sm btn-primary",children:"Retry"})})]})]})})]});const p=[{key:"id",header:"Task ID",sortable:!0,render:m=>s.jsx("span",{className:"font-mono text-sm",children:m})},{key:"className",header:"Type",sortable:!0,render:m=>s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:m})},{key:"lifecycleStatus",header:"Status",sortable:!0,render:m=>s.jsx(F,{status:m,animated:!0})},{key:"executor",header:"Executor",sortable:!0,render:m=>s.jsx("span",{className:"text-sm text-gray-900",children:m||"Unassigned"})},{key:"heartbeat",header:"Heartbeat",sortable:!0,render:(m,c)=>{const f=x.get(c.id);let S=(f==null?void 0:f.heartbeat)??m??0;return c.lifecycleStatus==="Finished"&&(S=200),s.jsx("span",{className:`text-sm font-mono ${S>0?"text-green-600":"text-gray-400"}`,children:S})}},{key:"createDateTime",header:"Created",sortable:!0,render:m=>{try{const c=new Date(m);return isNaN(c.getTime())?s.jsx("span",{className:"text-sm text-gray-400",children:"Invalid date"}):s.jsx("span",{className:"text-sm text-gray-500",children:re(c,"MMM dd, HH:mm")})}catch(c){return console.warn("Invalid date value:",m,c),s.jsx("span",{className:"text-sm text-gray-400",children:"Invalid date"})}}},{key:"updateDateTime",header:"Updated",sortable:!0,render:m=>{try{const c=new Date(m);return isNaN(c.getTime())?s.jsx("span",{className:"text-sm text-gray-400",children:"Invalid date"}):s.jsx("span",{className:"text-sm text-gray-500",children:re(c,"MMM dd, HH:mm")})}catch(c){return console.warn("Invalid date value:",m,c),s.jsx("span",{className:"text-sm text-gray-400",children:"Invalid date"})}}}],C=[void 0,"Created","Assigning","Running","Paused","Finished","Failed","Cancelled"];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tasks"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Monitor and manage task execution"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(oe,{className:`h-5 w-5 ${l?"text-green-500":"text-red-500"}`}),s.jsx("span",{className:`text-sm font-medium ${l?"text-green-700":"text-red-700"}`,children:l?"Live Updates":"Disconnected"}),u&&s.jsx("span",{className:"text-xs text-red-500",title:u.message,children:"(Error)"})]}),s.jsx("select",{value:a||"",onChange:m=>r(m.target.value||void 0),className:"block w-40 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",children:C.map(m=>s.jsx("option",{value:m||"",children:m||"All Status"},m||"all"))})]})]}),s.jsx(le,{data:k,columns:p,loading:d,pagination:{page:t,pageSize:n,total:(i==null?void 0:i.total)||0,onPageChange:e}})]})}function ia(){return s.jsx(Ze,{children:s.jsx(Ve,{children:s.jsxs(Ne,{children:[s.jsx(q,{path:"/",element:s.jsx(Ge,{})}),s.jsx(q,{path:"/skalds",element:s.jsx(Ke,{})}),s.jsx(q,{path:"/tasks",element:s.jsx(na,{})})]})})})}class oa extends o.Component{constructor(){super(...arguments);v(this,"state",{hasError:!1})}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,r){console.error("ErrorBoundary caught an error:",a,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsx("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx($,{className:"h-8 w-8 text-red-400"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Something went wrong"}),s.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[s.jsx("p",{children:"An unexpected error occurred while rendering this page."}),this.state.error&&s.jsx("p",{className:"mt-2 font-mono text-xs bg-red-100 p-2 rounded",children:this.state.error.message})]}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-sm btn-primary",children:"Reload Page"})})]})]})})}):this.props.children}}const ca=new pe({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});V.createRoot(document.getElementById("root")).render(s.jsx(ke.StrictMode,{children:s.jsx(oa,{children:s.jsx(ye,{client:ca,children:s.jsx(Se,{basename:"/dashboard",children:s.jsx(ia,{})})})})}));
//# sourceMappingURL=index-Dx_9xAef.js.map
